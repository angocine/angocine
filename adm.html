<!DOCTYPE html><html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Painel Admin Conteúdos — ANGOCINE</title>  <style>
    :root{
      --bg:#001f3f;
      --panel:#0a2b4d;
      --panel-2:#0f3a6f;
      --accent:#ffcc00;
      --accent-2:#ff9900;
      --muted:#cbd5e1;
      --glass: rgba(255,255,255,0.04);
    }

    /* Reset e layout centralizado */
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, Roboto, Arial, sans-serif;
      background: linear-gradient(180deg,var(--bg),#00284d 120%);
      color:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
      -webkit-font-smoothing:antialiased;
    }

    .container{
      width:100%;
      max-width:920px;
      display:flex;
      flex-direction:column;
      gap:20px;
      align-items:center;
    }

    h1{
      margin:0;
      color:var(--accent);
      text-align:center;
      font-size:1.6rem;
      text-shadow:0 6px 18px rgba(0,0,0,0.6);
    }

    /* painel e seletor */
    .panel{
      width:100%;
      background: linear-gradient(180deg,var(--panel),var(--panel-2));
      border-radius:14px;
      padding:20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.6);
      display:flex;
      gap:18px;
      flex-direction:column;
      align-items:center;
    }

    .row{
      width:100%;
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:center;
    }

    .select-type{
      width:320px;
      background:var(--glass);
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.06);
      padding:8px 10px;
      color:var(--muted);
      font-weight:600;
      outline:none;
      transition: box-shadow .18s, transform .12s;
    }
    .select-type:focus{box-shadow:0 6px 18px rgba(0,0,0,0.5); transform:translateY(-2px);}

    /* formulário */
    form{
      width:100%;
      max-width:820px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      padding:18px;
      border-radius:10px;
      display:flex;
      flex-direction:column;
      gap:12px;
      align-items:center;
      border:1px solid rgba(255,255,255,0.04);
    }

    .fields{
      width:100%;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }

    .fields.full{ grid-template-columns: 1fr; }

    input[type="text"], input[type="number"], textarea{
      width:100%;
      padding:12px 14px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,0.04);
      background:#0f3a6f;
      color:#fff;
      font-size:14px;
      outline:none;
      transition: box-shadow .12s, transform .08s;
    }
    textarea{ min-height:80px; resize:vertical; grid-column:1/-1; }
    input:focus, textarea:focus{ box-shadow:0 6px 20px rgba(0,0,0,0.5); transform:translateY(-1px); border-color:rgba(255,204,0,0.12); }

    /* temporada / episodio */
    .temporadas-wrap{
      width:100%;
      display:flex;
      flex-direction:column;
      gap:12px;
      margin-top:6px;
    }

    .temporada{
      width:100%;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.04);
      padding:12px;
      border-radius:10px;
      display:flex;
      flex-direction:column;
      gap:8px;
      position:relative;
    }

    .temporada-header{
      font-weight:700;
      color:var(--accent);
      font-size:14px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
    }

    .episodios{
      display:flex;
      flex-direction:column;
      gap:8px;
      margin-top:6px;
    }

    .episodio{
      display:flex;
      gap:8px;
      align-items:center;
    }
    .ep-label{
      min-width:110px;
      font-weight:600;
      color:var(--muted);
      font-size:13px;
    }
    .ep-input{
      flex:1;
    }

    /* botões */
    .btn{
      padding:10px 16px;
      border-radius:10px;
      cursor:pointer;
      border:none;
      font-weight:700;
      letter-spacing:.2px;
      transition:transform .12s, box-shadow .12s;
    }

    .btn-primary{
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      color:#002040;
      box-shadow: 0 8px 26px rgba(0,0,0,0.45);
    }
    .btn-primary:hover{ transform:translateY(-4px); }

    .btn-ghost{
      background: transparent;
      border:1px solid rgba(255,255,255,0.06);
      color:var(--muted);
    }

    .controls{
      width:100%;
      display:flex;
      gap:10px;
      justify-content:flex-end;
      align-items:center;
    }

    .add-temp{
      align-self:flex-start;
      display:inline-flex;
      gap:8px;
      align-items:center;
      background:#00bfff;
      color:#002040;
      padding:8px 12px;
      border-radius:8px;
      font-weight:700;
      border:none;
      cursor:pointer;
    }
    .add-temp:hover{ transform:translateY(-3px); }

    /* mensagem */
    .mensagem{
      color:#b6f59b;
      font-weight:700;
      margin-top:6px;
    }

    /* responsivo */
    @media (max-width:880px){
      .fields{ grid-template-columns: 1fr; }
      .select-type{ width:100%;}
      .add-temp{ width:100%; justify-content:center; }
      .controls{ justify-content:center; flex-direction:column; gap:8px; }
    }

    @media (max-width:420px){
      body{ padding:12px; }
      .container{ max-width:100%;}
      h1{ font-size:1.2rem; }
    }
  </style></head>
<body>
  <div class="container">
    <h1>Painel Admin — ANGOCINE</h1><div class="panel" role="region" aria-label="Painel administrativo">
  <!-- tipo -->
  <div class="row">
    <select id="tipoConteudo" class="select-type" aria-label="Tipo de conteúdo">
      <option value="">— Selecionar tipo —</option>
      <option value="filme">Filme</option>
      <option value="serie">Série</option>
      <option value="anime">Anime</option>
      <option value="dorama">Dorama</option>
    </select>
  </div>

  <!-- formulário -->
  <form id="formConteudo" aria-label="Formulário de conteúdo">
    <div class="fields">
      <input id="titulo" type="text" placeholder="Título" required />
      <input id="ano" type="number" placeholder="Ano" required />
      <input id="genero" type="text" placeholder="Gênero (ex: Ação, Drama)" />
      <input id="imagem" type="text" placeholder="URL da Imagem" />
      <textarea id="descricao" placeholder="Descrição (curta)" rows="3"></textarea>
      <!-- linkFilme visível só para filmes -->
      <div id="linkFilmeContainer" style="display:none;">
        <input id="link" type="text" placeholder="Link do Filme / Download" />
      </div>
    </div>

    <!-- temporadas - aparece só para série/anime/dorama -->
    <div class="temporadas-wrap" id="temporadasContainer" style="display:none;"></div>

    <!-- adiciona temporada (visível para séries/animes/doramas) -->
    <div style="width:100%; display:flex; justify-content:space-between; align-items:center; gap:12px;">
      <button id="publicarBtn" class="btn btn-primary" type="submit" style="flex:0 0 auto;">Publicar</button>
      <button id="addTempBtn" type="button" class="add-temp" style="display:none;">+ Adicionar Temporada</button>
    </div>

    <div class="controls" style="margin-top:6px; width:100%; justify-content:flex-start;">
      <button id="limparBtn" type="button" class="btn btn-ghost">Limpar</button>
      <div class="mensagem" id="mensagem"></div>
    </div>
  </form>
</div>

  </div>  <!-- Firebase (modular) -->  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

    /* ======== CONFIGURAÇÃO DO FIREBASE ======== */
    const firebaseConfig = {
      apiKey: "AIzaSyC_5YYEx899qVIDbMguMigD3Zq0CSIWg-U",
      authDomain: "paineladminfilmes.firebaseapp.com",
      projectId: "paineladminfilmes",
      storageBucket: "paineladminfilmes.firebasestorage.app",
      messagingSenderId: "76091758574",
      appId: "1:76091758574:web:6aca9167578d2e20ff",
      measurementId: "G-00ZFT2DCY0"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    /* ============================================ */

    // Elementos
    const tipoSelect = document.getElementById('tipoConteudo');
    const form = document.getElementById('formConteudo');
    const linkFilmeContainer = document.getElementById('linkFilmeContainer');
    const temporadasContainer = document.getElementById('temporadasContainer');
    const addTempBtn = document.getElementById('addTempBtn');
    const mensagemEl = document.getElementById('mensagem');
    const limparBtn = document.getElementById('limparBtn');

    // Map para coleções (consistência com Home)
    const collMap = {
      filme: 'filmes',
      serie: 'series',
      anime: 'animes',
      dorama: 'doramas'
    };

    // Contadores
    let temporadaContador = 0;

    // Ao mudar tipo
    tipoSelect.addEventListener('change', () => {
      mensagemEl.textContent = '';
      temporadasContainer.innerHTML = '';
      temporadaContador = 0;

      if(tipoSelect.value === 'filme'){
        linkFilmeContainer.style.display = 'block';
        temporadasContainer.style.display = 'none';
        addTempBtn.style.display = 'none';
      } else if (tipoSelect.value === ''){
        linkFilmeContainer.style.display = 'none';
        temporadasContainer.style.display = 'none';
        addTempBtn.style.display = 'none';
      } else {
        // série / anime / dorama
        linkFilmeContainer.style.display = 'none';
        temporadasContainer.style.display = 'flex';
        addTempBtn.style.display = 'inline-flex';
        adicionarTemporada(); // criar 1ª temporada automaticamente
      }
    });

    // Adicionar temporada (com número automático)
    function adicionarTemporada(){
      temporadaContador++;
      const temporadaIndex = temporadaContador; // 1,2,3...
      const tempDiv = document.createElement('div');
      tempDiv.className = 'temporada';
      tempDiv.dataset.season = String(temporadaIndex);

      tempDiv.innerHTML = `
        <div class="temporada-header">
          <div>Temporada ${temporadaIndex}</div>
          <div style="display:flex; gap:8px;">
            <button type="button" class="btn btn-ghost btn-rem-temp" title="Remover temporada">Remover</button>
          </div>
        </div>
        <div class="episodios" data-season="${temporadaIndex}"></div>
        <div style="display:flex; gap:8px; align-items:center; margin-top:6px;">
          <button type="button" class="add-ep btn" style="background:#00bfff; color:#002040; border-radius:8px; padding:8px 12px;">+ Adicionar Episódio</button>
          <div style="color:var(--muted); font-weight:600;">(episódios numerados automaticamente)</div>
        </div>
      `;

      temporadasContainer.appendChild(tempDiv);

      const addEpBtn = tempDiv.querySelector('.add-ep');
      const episodiosWrap = tempDiv.querySelector('.episodios');

      // Contador de episódios por temporada (começa em 1)
      let epCounter = 1;

      // Ao adicionar episódio
      addEpBtn.addEventListener('click', () => {
        const epDiv = document.createElement('div');
        epDiv.className = 'episodio';
        epDiv.innerHTML = `
          <div class="ep-label">Episódio ${epCounter}</div>
          <input class="ep-input" type="text" placeholder="Link do episódio ${epCounter}" required />
          <button type="button" class="btn btn-ghost btn-remove-ep">Remover</button>
        `;
        episodiosWrap.appendChild(epDiv);

        // Remover episódio
        const removeEpBtn = epDiv.querySelector('.btn-remove-ep');
        removeEpBtn.addEventListener('click', () => {
          epDiv.remove();
          // não re-numera histórico — ao publicar usamos ordem atual como sequência
        });

        epCounter++;
      });

      // botão remover temporada
      const remTempBtn = tempDiv.querySelector('.btn-rem-temp');
      remTempBtn.addEventListener('click', () => {
        tempDiv.remove();
        // atualizar números das temporadas visuais
        renumerarTemporadas();
      });
    }

    // renumera temporadas (após remoção)
    function renumerarTemporadas(){
      const temps = Array.from(temporadasContainer.querySelectorAll('.temporada'));
      temporadaContador = 0;
      temps.forEach((t, idx) => {
        temporadaContador = idx + 1;
        t.dataset.season = String(temporadaContador);
        const header = t.querySelector('.temporada-header > div:first-child');
        if(header) header.textContent = `Temporada ${temporadaContador}`;
        // renumeração episódios labels
        const eps = Array.from(t.querySelectorAll('.episodio'));
        eps.forEach((ep, i) => {
          const label = ep.querySelector('.ep-label');
          if(label) label.textContent = `Episódio ${i+1}`;
        });
      });
    }

    // ligar botão adicionar temporada
    addTempBtn.addEventListener('click', () => adicionarTemporada());

    // limpar formulário
    limparBtn.addEventListener('click', () => {
      form.reset();
      temporadasContainer.innerHTML = '';
      temporadaContador = 0;
      linkFilmeContainer.style.display = 'none';
      addTempBtn.style.display = 'none';
      mensagemEl.textContent = '';
    });

    // Função para gerar slug simples
    function gerarSlug(text){
      return text.toString().toLowerCase()
        .normalize('NFD').replace(/[\u0300-\u036f]/g,'') // remover acentos
        .replace(/[^\w\s-]/g,'') // remover caracteres não permitidos
        .trim()
        .replace(/\s+/g,'-')
        .replace(/-+/g,'-');
    }

    // Ao enviar / publicar
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      mensagemEl.textContent = '';

      const tipo = tipoSelect.value;
      if(!tipo){ mensagemEl.textContent = 'Escolha o tipo de conteúdo.'; return; }

      const titulo = document.getElementById('titulo').value.trim();
      const descricao = document.getElementById('descricao').value.trim();
      const ano = Number(document.getElementById('ano').value) || null;
      const genero = document.getElementById('genero').value.trim();
      const imagem = document.getElementById('imagem').value.trim();

      if(!titulo){ mensagemEl.textContent = 'Título é obrigatório.'; return; }

      // montar objeto
      const obj = {
        titulo, descricao, ano, genero, imagem,
        slug: gerarSlug(titulo),
        criadoEm: new Date().toISOString()
      };

      if(tipo === 'filme'){
        const link = document.getElementById('link').value.trim();
        if(!link){ mensagemEl.textContent = 'Adicione o link do filme.'; return; }
        obj.link = link;
      } else {
        // coletar temporadas e episódios
        const temporadaNodes = Array.from(temporadasContainer.querySelectorAll('.temporada'));
        const temporadas = temporadaNodes.map((tNode, tIdx) => {
          const epNodes = Array.from(tNode.querySelectorAll('.episodio'));
          const episodios = epNodes.map((epNode, eIdx) => {
            const linkInput = epNode.querySelector('.ep-input');
            return {
              numero: eIdx + 1,
              link: linkInput ? linkInput.value.trim() : ''
            };
          }).filter(ep => ep.link); // remove vazios
          return {
            numero: tIdx + 1,
            episodios
          };
        }).filter(t => t.episodios && t.episodios.length > 0); // só temporadas com eps
        obj.temporadas = temporadas;
      }

      // escolher coleção
      const collName = collMap[tipo] || 'filmes';

      try {
        await addDoc(collection(db, collName), obj);
        mensagemEl.style.color = '#b6f59b';
        mensagemEl.textContent = 'Publicado com sucesso!';
        // limpar form (mas manter tipo para continuar adicionando)
        form.reset();
        temporadasContainer.innerHTML = '';
        temporadaContador = 0;
        if(tipo !== 'filme'){ adicionarTemporada(); } // cria 1 temporada vazia pronta
      } catch (err) {
        console.error('Erro ao publicar:', err);
        mensagemEl.style.color = '#ffb4b4';
        mensagemEl.textContent = 'Erro ao publicar. Veja o console.';
      }
    });
  </script></body>
</html>