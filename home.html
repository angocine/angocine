<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ANGOCINE - Streaming</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <!-- üî• SISTEMA DE SESS√ÉO -->
  <script>
    const usuario = JSON.parse(sessionStorage.getItem("usuarioLogado"));
    if (!usuario || Date.now() > usuario.expiraEm) {
      sessionStorage.removeItem("usuarioLogado");
      alert("Sua sess√£o expirou. Fa√ßa login novamente.");
      window.location.href = "index.html";
    }
  </script>

  <style>
    .sidebar {
      position: fixed;
      top: 0;
      left: -100%;
      width: 300px;
      height: 100%;
      background: #001f3f;
      color: #fff;
      transition: 0.3s;
      padding: 20px;
      z-index: 1000;
      overflow-y: auto;
      text-align: center;
    }
    .sidebar.active { left: 0; }

    .close-btn {
      font-size: 24px;
      cursor: pointer;
      position: absolute;
      top: 10px;
      right: 20px;
    }

    .admin-circle {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      overflow: hidden;
      margin: 20px auto 10px;
      border: 3px solid #fff;
    }

    .admin-circle img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .admin-name {
      font-size: 22px;
      font-weight: bold;
      margin-top: 10px;
      margin-bottom: 20px;
    }

    .btn-entrar {
      background: #ffcc00;
      color: #000;
      padding: 12px 25px;
      border-radius: 10px;
      font-size: 18px;
      font-weight: bold;
      display: inline-block;
      margin-bottom: 25px;
      cursor: pointer;
      text-decoration: none;
    }

    .nota-box {
      background: #003366;
      padding: 15px;
      border-radius: 10px;
      text-align: left;
      margin-top: 10px;
    }

    .nota-box h3 {
      margin: 0 0 10px;
      font-size: 18px;
      color: #ffcc00;
    }

    .nota-box p {
      font-size: 14px;
      line-height: 1.4;
    }
  </style>
</head>

<body>

<header class="top-bar">
  <i class="fas fa-bars menu-btn" id="menu-btn"></i>
  <h1>ANGOCINE</h1>
  <i class="fas fa-search" id="search-icon"></i>

  <form id="search-form" action="resultado.html" method="get" style="display:none;">
    <input type="text" name="busca" id="search-input" placeholder="Pesquisar...">
  </form>
</header>

<section class="banner" id="banner-container">
  <div class="banner-slides" id="banner-slides"></div>
</section>

<main id="conteudo-principal"></main>

<nav class="bottom-nav">
  <a href="#" data-tipo="inicio" class="ativo"><i class="fas fa-home"></i><span>IN√çCIO</span></a>
  <a href="#" data-tipo="filmes"><i class="fas fa-film"></i><span>FILMES</span></a>
  <a href="#" data-tipo="series"><i class="fas fa-tv"></i><span>S√âRIES</span></a>
  <a href="#" data-tipo="animes"><i class="fas fa-dragon"></i><span>ANIMES</span></a>
  <a href="#" data-tipo="doramas"><i class="fas fa-heart"></i><span>DORAMAS</span></a>
  <a href="#" data-tipo="catalogo"><i class="fas fa-book-open"></i><span>CAT√ÅLOGO</span></a>
  <a href="#" data-tipo="pagamento"><i class="fas fa-credit-card"></i><span>PAGAMENTO</span></a>
</nav>

<!-- Sidebar ADM -->
<div id="admin-sidebar" class="sidebar">
  <span class="close-btn" id="close-sidebar">&times;</span>

  <div class="admin-circle">
    <img src="Screenshot_20251110-144413.jpg" alt="Administrador">
  </div>

  <div class="admin-name">Formiga Spy</div>

  <a href="login-adm.html" class="btn-entrar">ENTRAR</a>

  <div class="nota-box">
    <h3>Nota Informativa</h3>
    <p>
      Este painel √© exclusivo para administradores autorizados.  
      Mantenha as suas credenciais em sigilo e evite acessos indevidos.
    </p>
  </div>
</div>

<script>
  /* ==== FIREBASE ==== */
  const firebaseConfig = {
    apiKey: "AIzaSyC_5YYEx899qVIDbMguMigD3Zq0CSIWg-U",
    authDomain: "paineladminfilmes.firebaseapp.com",
    projectId: "paineladminfilmes",
    storageBucket: "paineladminfilmes.firebasestorage.app",
    messagingSenderId: "76091758574",
    appId: "1:76091758574:web:6aca9167578d2a5d2e20ff",
    measurementId: "G-00ZFT2DCY0"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  document.addEventListener("DOMContentLoaded", () => {
    const bannerSlides = document.getElementById("banner-slides");
    const conteudo = document.getElementById("conteudo-principal");
    const botoes = document.querySelectorAll(".bottom-nav a");

    const catalogo = { filmes: [], series: [], animes: [], doramas: [] };

    /* === Carregar cole√ß√µes do mais recente ‚Üí mais antigo === */
    ["filmes", "series", "animes", "doramas"].forEach(cat => {
      db.collection(cat)
        .orderBy("criadoEm", "desc") // ‚Üê ORDEM CORRETA
        .onSnapshot(snapshot => {
          catalogo[cat] = [];
          snapshot.forEach(doc => {
            let item = doc.data();
            item.id = doc.id;
            item.tipo =
              cat === "filmes" ? "filme" :
              cat === "series" ? "serie" :
              cat === "animes" ? "anime" : "dorama";

            catalogo[cat].push(item);
          });

          mostrarInicio();
        });
    });

    function gerarCategoria(titulo, categoria) {
      if (!catalogo[categoria] || catalogo[categoria].length === 0) return;
      const section = document.createElement("section");
      section.className = "section";
      section.innerHTML = `
        <div class="section-header"><h3>${titulo}</h3></div>
        <div class="series-container">
          ${catalogo[categoria].map(item => `
            <div class="card ${categoria}">
              <span class="etiqueta">${categoria.toUpperCase()}</span>
              <a href="${item.tipo}.html?slug=${item.slug}" class="card-link">
                <img src="${item.imagem}" alt="${item.titulo}">
                <p>${item.titulo}</p>
                <p class="card-stars">${item.nota || '‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ'}</p>
              </a>
            </div>
          `).join("")}
        </div>
      `;
      conteudo.appendChild(section);
    }

    function mostrarInicio() {
      conteudo.innerHTML = "";
      gerarCategoria("Filmes", "filmes");
      gerarCategoria("S√©ries", "series");
      gerarCategoria("Animes", "animes");
      gerarCategoria("Doramas", "doramas");

      bannerSlides.innerHTML = "";

      /* === Banner com itens MAIS RECENTES === */
      const bannerItens = [
        ...catalogo.filmes.slice(0, 2), // 2 filmes mais novos
        ...catalogo.series.slice(0, 3)  // 3 s√©ries mais novas
      ];

      bannerItens.forEach(item => {
        const div = document.createElement("div");
        div.classList.add("slide");
        div.innerHTML = `
          <a href="${item.tipo}.html?slug=${item.slug}">
            <div class="banner-bg" style="background-image: url('${item.imagem}')"></div>
            <img class="banner-img" src="${item.imagem}">
            <div class="banner-info">
              <div class="banner-title">${item.titulo}</div>
              <p><span class="banner-stars">${item.nota || '‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ'}</span></p>
            </div>
          </a>
        `;
        bannerSlides.appendChild(div);
      });

      let index = 0;
      setInterval(() => {
        if (bannerItens.length === 0) return;
        index = (index + 1) % bannerItens.length;
        bannerSlides.style.transform = `translateX(-${index * 100}%)`;
      }, 5000);
    }

    botoes.forEach(botao => {
      botao.addEventListener("click", e => {
        const tipo = botao.getAttribute("data-tipo");
        if (tipo === "pagamento") return window.location.href = "pagamento.html";
        if (tipo === "catalogo") return window.location.href = "generos.html";
        e.preventDefault();
        botoes.forEach(b => b.classList.remove("ativo"));
        botao.classList.add("ativo");
        if (tipo === "inicio") return mostrarInicio();
        conteudo.innerHTML = "";
        gerarCategoria(tipo.toUpperCase(), tipo);
      });
    });

    document.getElementById("menu-btn").addEventListener("click", () =>
      document.getElementById("admin-sidebar").classList.add("active")
    );

    document.getElementById("close-sidebar").addEventListener("click", () =>
      document.getElementById("admin-sidebar").classList.remove("active")
    );

    document.getElementById("search-icon").addEventListener("click", () => {
      const form = document.getElementById("search-form");
      form.style.display = form.style.display === "block" ? "none" : "block";
    });
  });
</script>

</body>
</html>